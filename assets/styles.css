/* Base */
:root{--bg:#0d0f14;--bg-alt:#121621;--text:#e6e9ef;--muted:#9aa3b2;--brand:#7c5cff;--brand-2:#00d1b2;--card:#151a27;--border:#23293a;--shadow:0 8px 24px rgba(0,0,0,.35)}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:linear-gradient(180deg,#0b0e13, #0f1320 40%, #0b0e13);color:var(--text);line-height:1.6}
a{color:inherit;text-decoration:none}
img{max-width:100%;display:block}
.container{max-width:1100px;margin:0 auto;padding:0 16px}
.section{padding:64px 0}
.section.alt{background:var(--bg-alt)}
.center{text-align:center}
.muted{color:var(--muted)}
.skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
.skip-link:focus{position:fixed;left:16px;top:16px;width:auto;height:auto;background:#000;color:#fff;padding:8px 12px;border-radius:6px}

/* Header */
.site-header{position:sticky;top:0;background:rgba(13,15,20,.75);backdrop-filter:blur(8px);border-bottom:1px solid var(--border);z-index:10}
.header-inner{display:flex;align-items:center;justify-content:space-between;height:64px;position:relative}
.brand{display:flex;align-items:center;gap:10px}
.brand-mark{color:var(--brand)}
.brand-name{font-weight:700;letter-spacing:.4px}
.brand .brand-name{cursor:default}
.site-nav ul{display:flex;gap:16px;list-style:none;margin:0;padding:0;align-items:center}
.site-nav a{padding:8px 10px;border-radius:8px;color:var(--muted)}
.site-nav a[aria-current="page"],.site-nav a:hover{color:#fff;background:rgba(124,92,255,.1)}

/* Center the Главная link across the whole header */
.nav-center{position:absolute;left:50%;transform:translateX(-50%)}
.nav-center a{text-align:center}

/* Hero */
.hero{padding:72px 0;background:radial-gradient(1000px 300px at 20% 0, rgba(124,92,255,.18), transparent),radial-gradient(800px 300px at 80% 20%, rgba(0,209,178,.18), transparent)}
.hero-inner{display:grid;grid-template-columns:1.2fr .8fr;gap:28px;align-items:center}
.main-title{font-size:clamp(48px,6vw,72px);line-height:1;margin:0 0 16px;font-weight:900;letter-spacing:2px;text-align:center;color:#fff;text-shadow:0 0 20px rgba(124,92,255,.5)}
.title{font-size:clamp(32px,4vw,48px);line-height:1.1;margin:0 0 8px;text-align:center}
.subtitle{color:var(--muted);margin:0 0 18px;text-align:center}
.cta-row{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.button{display:inline-block;padding:10px 16px;border-radius:10px;border:1px solid var(--border);transition:.2s ease;box-shadow:var(--shadow)}
.button.primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#0b0e13;border-color:transparent}
.button.ghost{background:transparent;color:var(--text)}
.button:hover{transform:translateY(-1px);filter:saturate(1.1)}
.hero-art{display:grid;place-items:center}
.sigil{width:180px;height:180px;border:3px solid var(--brand);border-radius:16px;position:relative;transform:rotate(45deg);box-shadow:0 0 0 3px rgba(124,92,255,.15), 0 0 80px rgba(124,92,255,.25)}
.sigil:before,.sigil:after{content:"";position:absolute;inset:18%;border:2px dashed var(--brand-2);border-radius:12px}
.sigil:after{inset:36%;border-style:solid;border-color:rgba(0,209,178,.6)}

/* Grid / Cards */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:24px}
.cards{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;box-shadow:var(--shadow)}
.facts .list{margin:0;padding-left:18px}
.facts li{margin:6px 0}
.kv{margin:0}
.kv-row{display:grid;grid-template-columns:180px 1fr;gap:12px;padding:10px 12px;border-bottom:1px solid var(--border);align-items:start}
.kv-row:last-child{border-bottom:none}
.kv dt{color:var(--muted)}
.kv dd{margin:0}

/* Table */
.table-wrap{overflow:auto;border:1px solid var(--border);border-radius:12px}
table.stats{width:100%;border-collapse:separate;border-spacing:0}
table.stats thead th{background:rgba(124,92,255,.08);text-align:left}
table.stats th,table.stats td{padding:12px 14px;border-bottom:1px solid var(--border)}
table.stats tr:last-child td{border-bottom:none}

/* Gallery */
.gallery-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.ph{margin:0}
.ph-box{aspect-ratio:1/1;border-radius:12px;background:linear-gradient(135deg, rgba(124,92,255,.22), rgba(0,209,178,.22));border:1px dashed var(--border)}
.ph figcaption{margin-top:6px;color:var(--muted);font-size:14px}

/* Prose */
.prose{max-width:800px}
.lead{color:var(--muted);font-size:18px}
blockquote{margin:16px 0;padding:12px 16px;border-left:3px solid var(--brand);background:rgba(124,92,255,.06);border-radius:8px}
.end{color:var(--muted)}
.back-cta{margin-top:16px}
/* History page polish */
.chapter{margin:0}
.divider{display:none}
.timeline{position:relative;margin:28px 0 0;padding-left:24px}
.timeline:before{content:"";position:absolute;left:6px;top:0;bottom:0;width:2px;background:linear-gradient(180deg,rgba(124,92,255,.6),rgba(0,209,178,.6))}
.event{position:relative;margin:0 0 28px;padding:16px 16px 16px 18px;background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow)}
.event:before{content:"";position:absolute;left:-21px;top:18px;width:12px;height:12px;border-radius:50%;background:var(--brand);box-shadow:0 0 0 3px rgba(124,92,255,.2)}
.event h3{margin:0 0 6px;font-size:20px}
.event .meta{color:var(--muted);font-size:13px;margin:0 0 8px}
.event p{margin:10px 0}

/* Footer */
.site-footer{border-top:1px solid var(--border);background:rgba(13,15,20,.8)}
.footer-inner{display:flex;gap:12px;justify-content:space-between;align-items:center;min-height:64px}
.site-footer nav{display:flex;gap:12px}
.site-footer a{color:var(--muted)}
.site-footer a:hover{color:#fff}

/* Main expandable chapter */
.expandable-chapter {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  margin: 32px 0;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(0,0,0,.15);
  transition: all 0.3s ease;
}

.expandable-chapter:hover {
  box-shadow: 0 8px 30px rgba(0,0,0,.25);
  transform: translateY(-2px);
}

.chapter-header {
  background: linear-gradient(135deg, rgba(124,92,255,.1), rgba(0,209,178,.1));
  padding: 24px 32px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.3s ease;
  border-bottom: 1px solid transparent;
}

.chapter-header:hover {
  background: linear-gradient(135deg, rgba(124,92,255,.15), rgba(0,209,178,.15));
  border-bottom-color: var(--brand);
}

.chapter-header h2 {
  margin: 0;
  color: var(--text);
  font-size: 24px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.expand-icon {
  font-size: 24px;
  color: var(--brand);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  font-weight: bold;
}

.expand-icon.expanded {
  transform: rotate(180deg);
  color: var(--brand-2);
}

.chapter-content {
  display: none;
  background: rgba(0,0,0,.02);
  opacity: 0;
  transform: translateY(-15px);
  transition: opacity 0.5s ease, transform 0.5s ease;
}

.chapter-content.expanded {
  display: block;
  opacity: 1;
  transform: translateY(0);
}

.chapter-content > div {
  overflow: hidden;
  padding: 0 32px;
  opacity: 0;
  transform: translateY(15px);
  transition: opacity 0.5s ease, transform 0.5s ease;
}

.chapter-content.expanded > div {
  padding: 32px;
  opacity: 1;
  transform: translateY(0);
}

/* Sub-chapters with Roman numerals */
.sub-chapter {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  margin: 16px 0;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,.2);
  transition: all 0.3s ease;
}

.sub-chapter:hover {
  box-shadow: 0 6px 20px rgba(0,0,0,.3);
  transform: translateY(-2px);
}

.sub-chapter-header {
  background: linear-gradient(135deg, rgba(124,92,255,.08), rgba(0,209,178,.08));
  padding: 16px 20px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.3s ease;
  border-bottom: 1px solid transparent;
}

.sub-chapter-header:hover {
  background: linear-gradient(135deg, rgba(124,92,255,.12), rgba(0,209,178,.12));
  border-bottom-color: var(--brand);
}

.sub-chapter-header h3 {
  margin: 0;
  color: var(--text);
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 12px;
  transition: all 0.3s ease;
}

.sub-chapter-header:hover h3 {
  color: var(--brand);
  transform: translateX(5px);
}

.roman-numeral {
  background: linear-gradient(135deg, var(--brand), var(--brand-2));
  color: #0b0e13;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 14px;
  box-shadow: 0 2px 8px rgba(124,92,255,.3);
  flex-shrink: 0;
}

.sub-expand-icon {
  font-size: 18px;
  color: var(--brand);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  font-weight: bold;
}

.sub-expand-icon.expanded {
  transform: rotate(90deg);
  color: var(--brand-2);
}

.sub-chapter-content {
  height: 0;
  overflow: hidden;
  transition: height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  background: rgba(0,0,0,.02);
  padding: 0 20px;
}

.sub-chapter-content.expanded {
  height: auto;
  padding: 20px;
}

.sub-chapter-content .meta {
  color: var(--brand-2);
  font-size: 14px;
  font-weight: 500;
  margin: 0 0 16px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.sub-chapter-content p {
  margin: 12px 0;
  line-height: 1.7;
  color: var(--text);
}

/* Вложенные подглавы (подглавы внутри подглав) */
.sub-chapter-content .sub-chapter {
  background: rgba(0,0,0,.03);
  border: 1px solid rgba(124,92,255,.2);
  border-radius: 10px;
  margin: 12px 0;
  box-shadow: 0 2px 8px rgba(0,0,0,.15);
  transition: all 0.3s ease;
}

.sub-chapter-content .sub-chapter:hover {
  box-shadow: 0 4px 16px rgba(0,0,0,.25);
  transform: translateY(-1px);
}

.sub-chapter-content .sub-chapter-header {
  background: linear-gradient(135deg, rgba(124,92,255,.05), rgba(0,209,178,.05));
  padding: 14px 18px;
}

.sub-chapter-content .sub-chapter-header:hover {
  background: linear-gradient(135deg, rgba(124,92,255,.08), rgba(0,209,178,.08));
}

.sub-chapter-content .sub-chapter-header h3 {
  font-size: 16px;
  gap: 10px;
}

.sub-chapter-content .roman-numeral {
  width: 24px;
  height: 24px;
  font-size: 12px;
}

.sub-chapter-content .sub-chapter-content {
  height: 0;
  overflow: hidden;
  transition: height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  background: rgba(0,0,0,.01);
  padding: 0 18px;
}

.sub-chapter-content .sub-chapter-content.expanded {
  height: auto;
  padding: 18px;
}

.sub-chapter-content .sub-chapter-content .meta {
  font-size: 13px;
  margin: 0 0 14px;
}

.sub-chapter-content .sub-chapter-content p {
  margin: 10px 0;
  font-size: 15px;
  line-height: 1.6;
}

/* Timeline styling for sub-chapters */
.timeline {
  position: relative;
  padding-left: 0;
}

.timeline:before {
  display: none;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .sub-chapter-header h3 {
    font-size: 16px;
    gap: 8px;
  }
  
  .roman-numeral {
    width: 24px;
    height: 24px;
    font-size: 12px;
  }
  
  .sub-chapter-header {
    padding: 14px 16px;
  }
  
  .sub-chapter-content.expanded {
    padding: 16px;
  }
}

/* Responsive */
@media (max-width: 900px){
  .hero-inner{grid-template-columns:1fr}
  .cards{grid-template-columns:repeat(2,1fr)}
  .gallery-grid{grid-template-columns:repeat(2,1fr)}
  .grid-2{grid-template-columns:1fr}
  .main-title{font-size:clamp(36px,8vw,48px)}
  .title{font-size:clamp(24px,6vw,32px)}
}
@media (max-width: 520px){
  .cards{grid-template-columns:1fr}
  .gallery-grid{grid-template-columns:1fr}
  .main-title{font-size:32px}
  .title{font-size:20px}
  .cta-row{flex-direction:column;align-items:center}
}
.sub-chapter-header:hover .roman-numeral {
  transform: scale(1.1);
  box-shadow: 0 4px 12px rgba(124,92,255,.4);
}

/* Site Navigation */
.site-nav ul{display:flex;gap:16px;list-style:none;margin:0;padding:0}
.site-nav a{padding:8px 10px;border-radius:8px;color:var(--muted)}
.site-nav a[aria-current="page"],.site-nav a:hover{color:#fff;background:rgba(124,92,255,.1)}

/* Dropdown Menu */
.dropdown-menu {
  position: relative;
  display: inline-block;
}

.dropdown-toggle {
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
}

.dropdown-toggle::after {
  content: '▼';
  font-size: 12px;
  transition: transform 0.3s ease;
  color: var(--brand);
  margin-left: 4px;
}

.dropdown-menu:hover .dropdown-toggle::after {
  transform: rotate(180deg);
  color: var(--brand-2);
}

.dropdown-menu:hover .dropdown-toggle {
  color: #fff;
  background: rgba(124,92,255,.1);
}

.dropdown-content {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0,0,0,.3);
  min-width: 160px;
  z-index: 1000;
  opacity: 0;
  transform: translateY(-10px);
  transition: all 0.3s ease;
}

.dropdown-menu:hover .dropdown-content {
  display: block;
  opacity: 1;
  transform: translateY(0);
}

.dropdown-item {
  display: block;
  padding: 12px 16px;
  color: var(--text);
  text-decoration: none;
  border-bottom: 1px solid var(--border);
  transition: all 0.2s ease;
}

.dropdown-item:last-child {
  border-bottom: none;
}

.dropdown-item:hover {
  background: rgba(124,92,255,.1);
  color: #fff;
  transform: translateX(5px);
}

.dropdown-item.active {
  background: rgba(124,92,255,.2);
  color: #fff;
  font-weight: 600;
}

/* Mobile dropdown support */
.dropdown-content.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .dropdown-content {
    position: static;
    box-shadow: none;
    border: none;
    margin-top: 8px;
    transform: none;
    opacity: 1;
  }
  
  .dropdown-menu:hover .dropdown-content {
    display: none;
  }
  
  .dropdown-content.show {
    display: block;
  }
}

/* Character Card Styles */
.character-card {
  text-align: center;
  margin: 32px 0;
}

.character-card h3 {
  color: var(--text);
  font-size: 24px;
  margin-bottom: 24px;
  font-weight: 600;
}

.character-frame {
  display: inline-block;
  border: 3px solid #ff0000;
  border-radius: 16px;
  padding: 20px;
  background: rgba(0,0,0,.3);
  box-shadow: 0 8px 32px rgba(255,0,0,.2);
  transition: all 0.3s ease;
}

.character-frame:hover {
  box-shadow: 0 12px 40px rgba(255,0,0,.3);
  transform: translateY(-4px);
}

.character-frame img {
  width: 300px;
  height: auto;
  border-radius: 12px;
  margin-bottom: 16px;
  box-shadow: 0 4px 16px rgba(0,0,0,.4);
}

.character-info h4 {
  color: #fff;
  font-size: 20px;
  margin: 0 0 8px 0;
  font-weight: 600;
}

.character-title {
  color: #ff4444;
  font-size: 16px;
  margin: 0;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Screenshot Card Styles */
.screenshot-card {
  text-align: center;
  margin: 32px 0;
}

.screenshot-card h3 {
  color: var(--text);
  font-size: 24px;
  margin-bottom: 24px;
  font-weight: 600;
}

.screenshot-frame {
  display: inline-block;
  border: 3px solid #ff0000;
  border-radius: 16px;
  padding: 20px;
  background: rgba(0,0,0,.3);
  box-shadow: 0 8px 32px rgba(255,0,0,.2);
  transition: all 0.3s ease;
}

.screenshot-frame:hover {
  box-shadow: 0 12px 40px rgba(255,0,0,.3);
  transform: translateY(-4px);
}

.screenshot-frame img {
  width: 300px;
  height: auto;
  border-radius: 12px;
  margin-bottom: 16px;
  box-shadow: 0 4px 16px rgba(0,0,0,.4);
}

.screenshot-info h4 {
  color: #fff;
  font-size: 20px;
  margin: 0 0 8px 0;
  font-weight: 600;
}

.screenshot-title {
  color: #ff4444;
  font-size: 16px;
  margin: 0;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Relationships grid */
.relations-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,360px));gap:24px;align-items:start;justify-content:center}
.relation-card{width:100%;max-width:360px;margin:0;background:linear-gradient(180deg, rgba(255,0,0,.08), rgba(255,0,0,.02));border:1px solid #3a0a0a;border-radius:16px;overflow:hidden;box-shadow:0 10px 30px rgba(255,0,0,.12);transition:transform .25s ease, box-shadow .25s ease}
.relation-card:hover{transform:translateY(-4px);box-shadow:0 16px 44px rgba(255,0,0,.2)}
.relation-card a{display:block}
.relation-card .image-wrap{aspect-ratio:3/4;overflow:hidden;background:#0b0e13}
.relation-card img{width:100%;height:100%;object-fit:cover;display:block;filter:saturate(1.05);object-position:center 40%}
.relation-caption{padding:16px 18px;text-align:center;border-top:1px solid rgba(255,0,0,.25);background:rgba(0,0,0,.25)}
.relation-caption h4{margin:0 0 6px 0;font-size:18px;color:#ffffff}
.relation-caption p{margin:0;color:#ff8b8b}
.relation-caption p.mentor-note{color:#ffd08a !important}

@media (max-width: 900px){
  .relations-grid{grid-template-columns:1fr}
}
@media (max-width: 520px){
  .relations-grid{grid-template-columns:1fr}
}

/* Wide container for full-width sections */
.container.wide{max-width:1400px}

/* Red themed expandable for Sith */
.expandable-chapter.red{border-color:#6b0b0b;box-shadow:0 8px 28px rgba(255,0,0,.15)}
.chapter-header.red{background:linear-gradient(135deg, rgba(255,0,0,.12), rgba(124,0,0,.12));border-bottom:none}
.chapter-header.red:hover{background:linear-gradient(135deg, rgba(255,0,0,.18), rgba(124,0,0,.18))}
.chapter-header.red::after{
  content:"";position:absolute;left:50%;bottom:0;transform:translateX(-50%);
  width:clamp(160px, 22vw, 360px);height:2px;border-radius:2px;
  background:linear-gradient(90deg, rgba(255,0,0,.0), rgba(255,0,0,.6), rgba(255,0,0,.0));
}
.chapter-header.red{position:relative}
.chapter-header.red h2{
  position:absolute;left:50%;transform:translateX(-50%);
  color:#ffdddd;background:rgba(255,0,0,.18);
  padding:8px 22px;border-radius:999px;
  text-align:center;max-width:60%;
  border:1px solid rgba(255,0,0,.35);
  box-shadow:0 6px 18px rgba(255,0,0,.15) inset;
}
.expand-icon{color:var(--brand)}

/* Yellow themed expandable for Mando */
.expandable-chapter.yellow{border-color:#8a6b00;box-shadow:0 8px 28px rgba(255,200,0,.15)}
.chapter-header.yellow{position:relative;background:linear-gradient(135deg, rgba(255,215,0,.18), rgba(200,150,0,.18)) !important;border-bottom:none}
.chapter-header.yellow:hover{background:linear-gradient(135deg, rgba(255,215,0,.18), rgba(200,150,0,.18))}
.chapter-header.yellow::after{content:"";position:absolute;left:50%;bottom:0;transform:translateX(-50%);width:clamp(160px,22vw,360px);height:2px;border-radius:2px;background:linear-gradient(90deg, rgba(255,200,0,.0), rgba(255,200,0,.7), rgba(255,200,0,.0))}
.chapter-header.yellow h2{position:absolute;left:50%;transform:translateX(-50%);color:#fff5cc;background:rgba(255,215,0,.18);padding:8px 22px;border-radius:999px;text-align:center;max-width:60%;border:1px solid rgba(255,215,0,.35);box-shadow:0 6px 18px rgba(255,215,0,.15) inset}

